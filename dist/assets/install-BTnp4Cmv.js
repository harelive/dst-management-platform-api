import{u as G,g as R,c as B,a as F,r as b,o as L,b as H,A as n,d as u,e as P,f as t,w as e,p as S,j as i,i as p,t as s,m as o,l as $,n as x,V as J,x as K}from"./index-Dcr4vpJk.js";import{t as I}from"./index-C_B8vjJv.js";import{b as Q}from"./tools-oCf4Tkyz.js";const W={class:"page-div"},X={class:"card-header"},Y={class:"card-header"},Z={class:"card-header"},ee={style:{"margin-top":"10px"}},te={key:0},le={key:1},se=J({name:"toolsInstall"}),re=Object.assign(se,{setup(ae){const{t:c}=G(),z=R(),y=B(()=>z.language),{isMobile:k}=F(),D=B(()=>z.isDark),_=b(!1),d=b(0),m=b({zh:"",en:""}),a=b({}),M=()=>{I.osInfo.get().then(l=>{a.value=l.data,a.value.Uptime=Q(l.data.Uptime,y.value)})},N=()=>{I.install.post().then(l=>{K(l.message),_.value=!0,A()})},T=()=>{I.installStatus.get().then(l=>{const h=l.data;d.value=h.process,m.value.zh=h.zh,m.value.en=h.en,(d.value===100||d.value===0)&&g()})};let f=null;const A=()=>{f=setInterval(()=>{T()},1e3)},g=()=>{f&&(clearInterval(f),f=null)};return L(()=>{M()}),H(()=>{g(),window.removeEventListener("beforeunload",g)}),(l,h)=>{const r=n("el-descriptions-item"),O=n("el-descriptions"),w=n("el-card"),v=n("el-col"),U=n("el-button"),V=n("el-result"),C=n("el-row"),j=n("el-alert"),q=n("el-tag"),E=n("el-progress");return u(),P("div",W,[t(C,{gutter:20},{default:e(()=>[t(v,{span:12,lg:12,md:12,sm:24,xs:24},{default:e(()=>[t(w,{shadow:"never",style:S(i(k)?"min-height: 300px":"min-height: 500px")},{header:e(()=>[p("span",X,s(i(c)("tools.install.systemInfo")),1)]),default:e(()=>[t(O,{border:"",column:1},{default:e(()=>[t(r,{label:l.$t("tools.install.architecture")},{default:e(()=>[o(s(a.value.Architecture),1)]),_:1},8,["label"]),t(r,{label:l.$t("tools.install.osType")},{default:e(()=>[o(s(a.value.OS),1)]),_:1},8,["label"]),t(r,{label:l.$t("tools.install.osName")},{default:e(()=>[o(s(a.value.Platform),1)]),_:1},8,["label"]),t(r,{label:l.$t("tools.install.osVersion")},{default:e(()=>[o(s(a.value.PlatformVersion),1)]),_:1},8,["label"]),t(r,{label:"CPU"},{default:e(()=>[o(s(a.value.CPUModel),1)]),_:1}),t(r,{label:i(c)("tools.install.cpuCore")},{default:e(()=>[o(s(a.value.CPUCores),1)]),_:1},8,["label"]),t(r,{label:l.$t("tools.install.memory")},{default:e(()=>[o(s((a.value.MemorySize/1024**3).toFixed(2))+" GB",1)]),_:1},8,["label"]),t(r,{label:l.$t("tools.install.uptime")},{default:e(()=>[o(s(a.value.Uptime),1)]),_:1},8,["label"])]),_:1})]),_:1},8,["style"])]),_:1}),t(v,{span:12,lg:12,md:12,sm:24,xs:24,style:S(i(k)?"margin-top: 20px":"margin-top: 0px")},{default:e(()=>[t(w,{shadow:"never",style:S(i(k)?"min-height: 300px":"min-height: 500px")},{header:e(()=>[p("span",Y,s(l.$t("tools.install.installCheck")),1)]),default:e(()=>[a.value.Platform==="ubuntu"||a.value.Platform==="centos"||a.value.Platform==="rocky"?(u(),$(V,{key:0,icon:"success",title:l.$t("tools.install.checkPass"),"sub-title":l.$t("tools.install.checkPassDesc")},{extra:e(()=>[t(U,{type:"primary",loading:_.value,onClick:N},{default:e(()=>[o(s(i(c)("tools.install.install")),1)]),_:1},8,["loading"])]),_:1},8,["title","sub-title"])):(u(),$(V,{key:1,icon:"warning",title:l.$t("tools.install.checkNotPass"),"sub-title":l.$t("tools.install.checkNotPassDesc")},{extra:e(()=>[t(U,{type:"warning",loading:_.value,onClick:N},{default:e(()=>[o(s(i(c)("tools.install.install")),1)]),_:1},8,["loading"])]),_:1},8,["title","sub-title"]))]),_:1},8,["style"])]),_:1},8,["style"])]),_:1}),t(C,{gutter:20},{default:e(()=>[t(v,{span:24,lg:24,md:24,sm:24,xs:24,style:{"margin-top":"20px"}},{default:e(()=>[t(j,{effect:D.value?"light":"dark",type:"success",closable:!1},{default:e(()=>[o(s(i(c)("tools.install.installTip")),1)]),_:1},8,["effect"])]),_:1})]),_:1}),_.value?(u(),$(C,{key:0,gutter:20},{default:e(()=>[t(v,{span:24,lg:24,md:24,sm:24,xs:24,style:{"margin-top":"20px"}},{default:e(()=>[t(w,{shadow:"never",style:{"min-height":"250px"}},{header:e(()=>[p("div",Z,[p("span",null,s(i(c)("tools.install.installProgress")),1),t(q,{type:"warning",style:{"font-weight":"lighter"}},{default:e(()=>[o(s(i(c)("tools.install.noClose")),1)]),_:1})])]),default:e(()=>[t(E,{percentage:d.value,status:d.value===100?"success":"","stroke-width":15,striped:"","striped-flow":""},null,8,["percentage","status"]),p("div",ee,[y.value==="zh"?(u(),P("span",te,s(m.value.zh),1)):x("",!0),y.value==="en"?(u(),P("span",le,s(m.value.en),1)):x("",!0)])]),_:1})]),_:1})]),_:1})):x("",!0)])}}});export{re as default};
