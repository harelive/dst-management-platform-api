import{u as J,a as K,g as L,c as B,o as Q,r as b,A as u,d as _,e as X,f as e,w as n,p as Y,j as c,i as w,m as i,t as r,l as V,V as Z,W as D,z as ee,x as A,v as ne,y as oe}from"./index-Dcr4vpJk.js";import{t as h}from"./index-C_B8vjJv.js";const le={class:"page-div"},te={class:"card-header"},ae={class:"el-form-item-msg"},se={class:"dialog-footer"},ue=Z({name:"toolsAnnounce"}),de=Object.assign(ue,{setup(ce){const{t}=J(),{isMobile:g}=K(),C=L();B(()=>C.isDark),B(()=>C.language),Q(()=>{v()});const q=b([]),v=()=>{h.announce.get().then(l=>{q.value=l.data})},y=b(""),S=()=>{s.value={name:"",enable:!0,content:"",frequency:600},D(()=>{m.value.clearValidate()}),y.value="post",d.value=!0},d=b(!1),m=b(),s=b({name:"",enable:!0,content:"",frequency:600}),z={name:[{required:!0,message:t("tools.announce.rules.name"),trigger:"blur"}],enable:[{required:!0,message:t("tools.announce.rules.enable"),trigger:"change"}],content:[{required:!0,message:t("tools.announce.rules.content"),trigger:"blur"}],frequency:[{required:!0,message:t("tools.announce.rules.frequency"),trigger:"blur"}]},T=()=>{if(s.value.frequency<1){ee(t("tools.announce.rules.frequencyMin"));return}switch(y.value){case"post":U();break;case"put":x();break}},U=()=>{m.value.validate(l=>{l&&h.announce.post(s.value).then(o=>{d.value=!1,A(o.message),v()})})},E=l=>{ne.confirm(t("tools.announce.deleteTip"),"Warning",{confirmButtonText:t("tools.announce.confirm"),cancelButtonText:t("tools.announce.cancel"),type:"warning"}).then(()=>{h.announce.delete(l).then(o=>{A(o.message),v()})}).catch(()=>{oe(t("home.canceled"))})},F=l=>{s.value=l,D(()=>{m.value.clearValidate()}),y.value="put",d.value=!0},x=()=>{m.value.validate(l=>{l&&h.announce.put(s.value).then(o=>{d.value=!1,A(o.message),v()})})};return(l,o)=>{const p=u("el-button"),f=u("el-table-column"),M=u("el-tag"),N=u("el-table"),R=u("el-result"),j=u("el-card"),I=u("el-col"),P=u("el-row"),$=u("el-input"),k=u("el-form-item"),W=u("el-switch"),O=u("el-form"),G=u("el-dialog");return _(),X("div",le,[e(P,{gutter:10},{default:n(()=>[e(I,{lg:24,md:24,sm:24,span:24,xs:24,style:{"margin-top":"10px"}},{default:n(()=>[e(j,{shadow:"never",style:Y(c(g)?"min-height: 500px":"min-height: 700px")},{header:n(()=>[w("div",te,[i(r(c(t)("tools.announce.title"))+" ",1),w("div",null,[e(p,{type:"success",size:"default",onClick:S},{default:n(()=>[i(r(c(t)("tools.announce.new")),1)]),_:1})])])]),default:n(()=>[q.value.length>0?(_(),V(N,{key:0,data:q.value,"tooltip-effect":"light",border:"",style:{width:"100%"},size:"small"},{default:n(()=>[e(f,{prop:"name",label:l.$t("tools.announce.name")},null,8,["label"]),e(f,{prop:"enable",label:l.$t("tools.announce.isEnable")},{default:n(a=>[a.row.enable?(_(),V(M,{key:0,type:"success"},{default:n(()=>[i(r(c(t)("tools.announce.enable")),1)]),_:1})):(_(),V(M,{key:1,type:"danger"},{default:n(()=>[i(r(c(t)("tools.announce.disable")),1)]),_:1}))]),_:1},8,["label"]),e(f,{prop:"frequency",label:l.$t("tools.announce.frequency")},{default:n(a=>o[6]||(o[6]=[])),_:1},8,["label"]),e(f,{prop:"content",label:l.$t("tools.announce.content"),"show-overflow-tooltip":""},{default:n(a=>o[7]||(o[7]=[])),_:1},8,["label"]),e(f,{prop:"actions",label:l.$t("tools.announce.actions"),width:"140",fixed:"right"},{default:n(a=>[e(p,{link:"",type:"primary",onClick:H=>F(a.row)},{default:n(()=>[i(r(c(t)("tools.announce.update")),1)]),_:2},1032,["onClick"]),e(p,{link:"",type:"danger",onClick:H=>E(a.row)},{default:n(()=>[i(r(c(t)("tools.announce.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])):(_(),V(R,{key:1,icon:"warning",title:l.$t("tools.announce.noData"),style:{"margin-top":"10%"}},null,8,["title"]))]),_:1},8,["style"])]),_:1})]),_:1}),e(G,{modelValue:d.value,"onUpdate:modelValue":o[5]||(o[5]=a=>d.value=a),"close-on-click-modal":!1,title:l.$t("tools.announce.new"),width:"60%"},{footer:n(()=>[w("div",se,[e(p,{onClick:o[4]||(o[4]=a=>d.value=!1)},{default:n(()=>[i(r(c(t)("tools.announce.cancel")),1)]),_:1}),e(p,{type:"primary",onClick:T},{default:n(()=>[i(r(c(t)("tools.announce.submit")),1)]),_:1})])]),default:n(()=>[e(O,{ref_key:"announceFormRef",ref:m,"label-position":c(g)?"top":"left",model:s.value,rules:z,"label-width":c(g)?"70":"auto",size:c(g)?"small":"large"},{default:n(()=>[e(k,{label:l.$t("tools.announce.name"),prop:"name"},{default:n(()=>[e($,{modelValue:s.value.name,"onUpdate:modelValue":o[0]||(o[0]=a=>s.value.name=a),disabled:y.value==="put"},null,8,["modelValue","disabled"])]),_:1},8,["label"]),e(k,{label:l.$t("tools.announce.isEnable"),prop:"enable"},{default:n(()=>[e(W,{modelValue:s.value.enable,"onUpdate:modelValue":o[1]||(o[1]=a=>s.value.enable=a)},null,8,["modelValue"])]),_:1},8,["label"]),e(k,{label:l.$t("tools.announce.content"),prop:"content"},{default:n(()=>[e($,{modelValue:s.value.content,"onUpdate:modelValue":o[2]||(o[2]=a=>s.value.content=a)},null,8,["modelValue"])]),_:1},8,["label"]),e(k,{label:l.$t("tools.announce.frequency"),prop:"frequency"},{default:n(()=>[e($,{modelValue:s.value.frequency,"onUpdate:modelValue":o[3]||(o[3]=a=>s.value.frequency=a),modelModifiers:{number:!0},min:1,step:1},null,8,["modelValue"]),w("div",ae,r(c(t)("tools.announce.frequencyTip")),1)]),_:1},8,["label"])]),_:1},8,["label-position","model","label-width","size"])]),_:1},8,["modelValue","title"])])}}});export{de as default};
