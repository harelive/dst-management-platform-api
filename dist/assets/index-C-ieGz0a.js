import{h as z,_ as Se,o as Ee,u as Le,a as Me,g as De,c as ce,E as Ue,r as f,b as Fe,d as v,e as me,f as t,w as e,i as h,t as n,j as a,k as q,l as g,m as i,n as x,p as pe,q as fe,F as Pe,s as Ae,v as Re,x as Y,y as Ne,z as ve,A as d,B as ge}from"./index-Dcr4vpJk.js";const B={roomInfo:{url:"/home/room_info",get:async function(m){return await z.get(this.url,m)}},sysInfo:{url:"/home/sys_info",get:async function(m){return await z.get(this.url,m)}},exec:{url:"/home/exec",post:async function(m){return await z.post(this.url,m)}},interface:{announce:{url:"/home/announce",post:async function(m){return await z.post(this.url,m)}},console:{url:"/home/console",post:async function(m){return await z.post(this.url,m)}}}},Z={dstVersion:{url:"/external/api/dst_version",get:async function(m){return await z.get(this.url,m)}},connectionCode:{url:"/external/api/connection_code",get:async function(m){return await z.get(this.url,m)}},modInfo:{url:"/external/api/mod_info",get:async function(m){return await z.get(this.url,m)}}},qe={class:"page-div"},Ke={class:"card-header"},Ge={class:"card-header"},Oe={class:"fcc"},je={class:"percentage-value"},He={class:"percentage-value"},We={class:"percentage-label"},Ye={class:"card-header"},Ze={class:"card-header"},Je={__name:"index",setup(m){Ee(()=>{he(),be(),_e(),ye(),ke()});const{t:o}=Le(),{isMobile:C}=Me(),M=De();ce(()=>M.isDark);const _=ce(()=>M.language),he=()=>{M.needUpdatePassword&&(Ue({title:o("home.updatePasswordTitle"),message:o("home.updatePassword"),type:"warning"}),M.needUpdatePassword=!1)};f(!1);const K=f(!1),G=f(!1),S=f({server:0,local:0}),D=f(""),_e=()=>{K.value=!0,Z.dstVersion.get().then(u=>{S.value=u.data}).finally(()=>{K.value=!1})},ye=()=>{G.value=!0,Z.connectionCode.get().then(u=>{D.value=u.data}).finally(()=>{G.value=!1})},c=f({roomSettingBase:{},seasonInfo:{season:{},cycles:0,elapsedDays:0,seasonLength:{summer:15,autumn:20,spring:20,winter:15},phase:{}},modsCount:0}),be=()=>{B.roomInfo.get().then(u=>{c.value=u.data})},J=u=>c.value.seasonInfo.cycles>-1?`(${c.value.seasonInfo.elapsedDays}/${c.value.seasonInfo.seasonLength[u]})`:"",y=f({cpu:0,memory:0,master:0,caves:0}),we=()=>{B.sysInfo.get().then(u=>{y.value=u.data})},Q=[{color:"#5cb87a",percentage:20},{color:"#1989fa",percentage:40},{color:"#e6a23c",percentage:60},{color:"#f56c6c",percentage:80},{color:"#6f7ad3",percentage:100}];let U=null;const ke=()=>{U=setInterval(()=>{!F.value&&!P.value&&we()},2e3)},X=()=>{U&&(clearInterval(U),U=null)},F=f(!1),P=f(!1),ee=u=>{if(y.value.master,u==="master"){const l={type:"masterSwitch",info:y.value.master};F.value=!0,B.exec.post(l).finally(()=>{F.value=!1})}else{const l={type:"cavesSwitch",info:y.value.caves};P.value=!0,B.exec.post(l).finally(()=>{P.value=!1})}},p=(u,l)=>{const V={startup:{en:"STARTUP",zh:"启动"},rollback:{en:"ROLLBACK",zh:"回档"},shutdown:{en:"SHUTDOWN",zh:"关闭"},restart:{en:"RESTART",zh:"重启"},update:{en:"UPDATE GAME",zh:"更新游戏"},reset:{en:"RESET GAME",zh:"重置游戏"},delete:{en:"DELETE GAME",zh:"删除世界"}};Re.confirm(_.value==="zh"?`将执行 ${V[u].zh} 操作，是否继续？`:`The ${V[u].en} operation will be performed. Do you want to continue?`,_.value==="zh"?"请确认您的操作":"Please confirm your operation",{confirmButtonText:_.value==="zh"?"确定":"confirm",cancelButtonText:_.value==="zh"?"取消":"cancel",type:"warning",beforeClose:(T,r,b)=>{if(T==="confirm"){r.confirmButtonLoading=!0;const A={type:u,info:l};B.exec.post(A).then(w=>{Y(w.message),b()}).catch(()=>{}).finally(()=>{r.confirmButtonLoading=!1})}else b()}}).then(()=>{}).catch(()=>{Ne(o("home.canceled"))})},O=f(!1),E=f({message:""}),te=()=>{if(E.value.message===""){ve(_.value==="zh"?"请输入要宣告的内容":"Please enter the content to be announced");return}O.value=!0,B.interface.announce.post(E.value).then(u=>{Y(u.message),E.value.message=""}).finally(()=>{O.value=!1})},j=f(!1),I=f({cmd:"",world:"master"}),le=()=>{if(I.value.cmd===""){ve(_.value==="zh"?"请输入要执行的命令":"Please enter the command to execute");return}j.value=!0,B.interface.console.post(I.value).then(u=>{Y(u.message),I.value.cmd=""}).finally(()=>{j.value=!1})},H=f(!1),W=f(!1),ae=f([]),xe=()=>{H.value=!0,W.value=!0,Z.modInfo.get().then(u=>{ae.value=u.data}).finally(()=>{W.value=!1})},ze=u=>{if(u===0)return"0 B";const l=1024,V=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],T=Math.floor(Math.log(u)/Math.log(l));return parseFloat((u/Math.pow(l,T)).toFixed(2))+" "+V[T]};return Fe(()=>{X(),window.removeEventListener("beforeunload",X)}),(u,l)=>{const V=d("DocumentCopy"),T=d("el-icon"),r=d("el-button"),b=d("el-descriptions-item"),A=d("el-tooltip"),w=d("el-tag"),Ce=d("el-descriptions"),R=d("el-card"),k=d("el-col"),oe=d("el-progress"),ne=d("el-row"),se=d("el-switch"),$=d("el-form-item"),N=d("el-form"),ue=d("el-input"),ie=d("el-option"),Ie=d("el-select"),L=d("el-table-column"),$e=d("el-image"),Be=d("el-table"),Ve=d("el-dialog"),re=ge("copy"),de=ge("loading");return v(),me("div",qe,[t(ne,{gutter:10},{default:e(()=>[t(k,{span:12,lg:12,md:12,sm:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[t(R,{shadow:"never",style:{"min-height":"250px"}},{header:e(()=>[h("div",Ke,n(a(o)("home.roomInfo")),1)]),default:e(()=>[t(Ce,{column:a(C)?1:2},{default:e(()=>[t(b,{label:a(o)("home.roomName")},{default:e(()=>[q((v(),g(r,{link:"",type:"primary"},{default:e(()=>[i(n(c.value.roomSettingBase.name)+" ",1),t(T,{style:{"margin-left":"3px"}},{default:e(()=>[t(V)]),_:1})]),_:1})),[[re,c.value.roomSettingBase.name]])]),_:1},8,["label"]),t(b,{label:a(o)("home.connectionCode")},{default:e(()=>[t(A,{effect:"light",content:D.value,placement:"top"},{default:e(()=>[q((v(),g(r,{disabled:D.value==="",link:"",loading:G.value,type:"primary"},{default:e(()=>[i(n(a(o)("home.copy")),1)]),_:1},8,["disabled","loading"])),[[re,D.value]])]),_:1},8,["content"])]),_:1},8,["label"]),t(b,{label:a(o)("home.cycles")},{default:e(()=>[t(w,{type:c.value.seasonInfo.cycles>-1?"success":"danger"},{default:e(()=>[i(n(c.value.seasonInfo.cycles),1)]),_:1},8,["type"])]),_:1},8,["label"]),t(b,{label:a(o)("home.phase")},{default:e(()=>[_.value==="en"?(v(),g(w,{key:0,type:c.value.seasonInfo.phase.en==="Failed to retrieve"?"danger":"success"},{default:e(()=>[i(n(c.value.seasonInfo.phase.en),1)]),_:1},8,["type"])):x("",!0),_.value==="zh"?(v(),g(w,{key:1,type:c.value.seasonInfo.phase.zh==="获取失败"?"danger":"success"},{default:e(()=>[i(n(c.value.seasonInfo.phase.zh),1)]),_:1},8,["type"])):x("",!0)]),_:1},8,["label"]),t(b,{label:a(o)("home.season")},{default:e(()=>[_.value==="en"?(v(),g(w,{key:0,type:c.value.seasonInfo.cycles>-1?"success":"danger"},{default:e(()=>[i(n(c.value.seasonInfo.season.en)+" "+n(J(c.value.seasonInfo.season.en)),1)]),_:1},8,["type"])):x("",!0),_.value==="zh"?(v(),g(w,{key:1,type:c.value.seasonInfo.cycles>-1?"success":"danger"},{default:e(()=>[i(n(c.value.seasonInfo.season.zh)+" "+n(J(c.value.seasonInfo.season.en)),1)]),_:1},8,["type"])):x("",!0)]),_:1},8,["label"]),t(b,{label:a(o)("home.mods")},{default:e(()=>[t(w,null,{default:e(()=>[i(n(c.value.modsCount),1)]),_:1}),t(r,{link:"",type:"primary",onClick:xe,style:{"margin-left":"10px"}},{default:e(()=>[i(n(a(o)("home.modsButton")),1)]),_:1})]),_:1},8,["label"]),t(b,{label:a(o)("home.version")},{default:e(()=>[q((v(),g(w,{type:S.value.local===S.value.server?"success":"danger"},{default:e(()=>[i("("+n(S.value.local)+"/"+n(S.value.server)+")",1)]),_:1},8,["type"])),[[de,K.value]])]),_:1},8,["label"])]),_:1},8,["column"])]),_:1})]),_:1}),t(k,{span:12,lg:12,md:12,sm:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[t(R,{shadow:"never",style:{"min-height":"250px"}},{header:e(()=>[h("div",Ge,n(a(o)("home.sysInfo")),1)]),default:e(()=>[h("div",Oe,[t(oe,{type:"dashboard",percentage:y.value.cpu,color:Q},{default:e(({percentage:s})=>[h("span",je,n(s.toFixed(1)),1),l[24]||(l[24]=h("span",{class:"percentage-label"},"CPU",-1))]),_:1},8,["percentage"]),t(oe,{type:"dashboard",percentage:y.value.memory,color:Q,style:{"margin-left":"10%"}},{default:e(({percentage:s})=>[h("span",He,n(s.toFixed(1)),1),h("span",We,n(a(o)("home.mem")),1)]),_:1},8,["percentage"])])]),_:1})]),_:1})]),_:1}),t(ne,{gutter:10},{default:e(()=>[t(k,{span:12,lg:12,md:12,sm:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[t(R,{shadow:"never",style:pe(a(C)?"min-height: 300px":"min-height: 400px")},{header:e(()=>[h("div",Ye,n(a(o)("home.control")),1)]),default:e(()=>[h("div",null,[t(N,{size:"large",inline:""},{default:e(()=>[t($,{label:u.$t("home.master")},{default:e(()=>[t(se,{modelValue:y.value.master,"onUpdate:modelValue":l[0]||(l[0]=s=>y.value.master=s),"active-value":1,"inactive-value":0,onChange:l[1]||(l[1]=s=>ee("master")),loading:F.value,"inline-prompt":"","active-text":u.$t("home.running"),"inactive-text":u.$t("home.terminated")},null,8,["modelValue","loading","active-text","inactive-text"])]),_:1},8,["label"]),t($,{label:u.$t("home.caves")},{default:e(()=>[t(se,{modelValue:y.value.caves,"onUpdate:modelValue":l[2]||(l[2]=s=>y.value.caves=s),"active-value":1,"inactive-value":0,onChange:l[3]||(l[3]=s=>ee("caves")),loading:P.value,"inline-prompt":"","active-text":u.$t("home.running"),"inactive-text":u.$t("home.terminated")},null,8,["modelValue","loading","active-text","inactive-text"])]),_:1},8,["label"])]),_:1}),t(N,{size:"large"},{default:e(()=>[t($,{label:u.$t("home.rollback")},{default:e(()=>[a(C)?(v(),g(k,{key:0},{default:e(()=>[t(r,{size:"small",onClick:l[4]||(l[4]=s=>p("rollback",1))},{default:e(()=>[i("1"+n(a(o)("home.day")),1)]),_:1}),t(r,{size:"small",onClick:l[5]||(l[5]=s=>p("rollback",2))},{default:e(()=>[i("2"+n(a(o)("home.days")),1)]),_:1}),t(r,{size:"small",onClick:l[6]||(l[6]=s=>p("rollback",3))},{default:e(()=>[i("3"+n(a(o)("home.days")),1)]),_:1})]),_:1})):x("",!0),a(C)?(v(),g(k,{key:1},{default:e(()=>[t(r,{size:"small",onClick:l[7]||(l[7]=s=>p("rollback",4))},{default:e(()=>[i("4"+n(a(o)("home.days")),1)]),_:1}),t(r,{size:"small",onClick:l[8]||(l[8]=s=>p("rollback",5))},{default:e(()=>[i("5"+n(a(o)("home.days")),1)]),_:1})]),_:1})):x("",!0),a(C)?(v(),g(k,{key:2})):x("",!0),a(C)?x("",!0):(v(),g(k,{key:3},{default:e(()=>[t(r,{size:"small",onClick:l[9]||(l[9]=s=>p("rollback",1))},{default:e(()=>[i("1"+n(a(o)("home.day")),1)]),_:1}),t(r,{size:"small",onClick:l[10]||(l[10]=s=>p("rollback",2))},{default:e(()=>[i("2"+n(a(o)("home.days")),1)]),_:1}),t(r,{size:"small",onClick:l[11]||(l[11]=s=>p("rollback",3))},{default:e(()=>[i("3"+n(a(o)("home.days")),1)]),_:1}),t(r,{size:"small",onClick:l[12]||(l[12]=s=>p("rollback",4))},{default:e(()=>[i("4"+n(a(o)("home.days")),1)]),_:1}),t(r,{size:"small",onClick:l[13]||(l[13]=s=>p("rollback",5))},{default:e(()=>[i("5"+n(a(o)("home.days")),1)]),_:1})]),_:1}))]),_:1},8,["label"])]),_:1}),t(N,{size:"large"},{default:e(()=>[t($,null,{default:e(()=>[t(r,{type:"success",size:"default",onClick:l[14]||(l[14]=s=>p("startup",0))},{default:e(()=>[i(n(a(o)("home.startup")),1)]),_:1}),t(r,{type:"primary",size:"default",onClick:l[15]||(l[15]=s=>p("restart",0))},{default:e(()=>[i(n(a(o)("home.restart")),1)]),_:1}),t(r,{type:"warning",size:"default",onClick:l[16]||(l[16]=s=>p("update",0))},{default:e(()=>[i(n(a(o)("home.update")),1)]),_:1})]),_:1}),t($,null,{default:e(()=>[t(r,{type:"warning",size:"default",onClick:l[17]||(l[17]=s=>p("shutdown",0))},{default:e(()=>[i(n(a(o)("home.shutdown")),1)]),_:1}),t(r,{type:"danger",size:"default",onClick:l[18]||(l[18]=s=>p("reset",0))},{default:e(()=>[i(n(a(o)("home.reset")),1)]),_:1}),t(A,{effect:"light",content:u.$t("home.deleteTips"),placement:"top"},{default:e(()=>[t(r,{color:"#626aef",size:"default",onClick:l[19]||(l[19]=s=>p("delete",0))},{default:e(()=>[i(n(a(o)("home.delete")),1)]),_:1})]),_:1},8,["content"])]),_:1})]),_:1})])]),_:1},8,["style"])]),_:1}),t(k,{span:12,lg:12,md:12,sm:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[t(R,{shadow:"never",style:pe(a(C)?"min-height: 300px":"min-height: 400px")},{header:e(()=>[h("div",Ze,n(a(o)("home.interface")),1)]),default:e(()=>[h("div",null,[t(N,{"label-position":"top"},{default:e(()=>[t($,{label:u.$t("home.announcement")},{default:e(()=>[t(ue,{modelValue:E.value.message,"onUpdate:modelValue":l[20]||(l[20]=s=>E.value.message=s),onKeyup:fe(te,["enter"])},{append:e(()=>[t(r,{loading:O.value,onClick:te},{default:e(()=>[i(n(a(o)("home.send")),1)]),_:1},8,["loading"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),t($,{label:"Console"},{default:e(()=>[t(ue,{modelValue:I.value.cmd,"onUpdate:modelValue":l[22]||(l[22]=s=>I.value.cmd=s),onKeyup:fe(le,["enter"])},{prepend:e(()=>[t(Ie,{modelValue:I.value.world,"onUpdate:modelValue":l[21]||(l[21]=s=>I.value.world=s),style:{width:"115px"}},{default:e(()=>[t(ie,{label:u.$t("home.master"),value:"master"},null,8,["label"]),t(ie,{label:u.$t("home.caves"),value:"caves"},null,8,["label"])]),_:1},8,["modelValue"])]),append:e(()=>[t(r,{loading:j.value,onClick:le},{default:e(()=>[i(n(a(o)("home.execute")),1)]),_:1},8,["loading"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1},8,["style"])]),_:1})]),_:1}),t(Ve,{modelValue:H.value,"onUpdate:modelValue":l[23]||(l[23]=s=>H.value=s),"close-on-click-modal":!1,title:a(o)("home.modsTable.title"),width:"80%"},{default:e(()=>[q((v(),g(Be,{data:ae.value,"tooltip-effect":"light",height:"70vh",border:"",style:{width:"100%"},size:"small"},{default:e(()=>[t(L,{prop:"name",label:a(o)("home.modsTable.name")},null,8,["label"]),t(L,{prop:"preview_url",label:a(o)("home.modsTable.pics"),width:"120px"},{default:e(s=>[t($e,{style:{width:"100px",height:"100px"},src:s.row.preview_url,fit:"fill"},null,8,["src"])]),_:1},8,["label"]),t(L,{prop:"size",label:a(o)("home.modsTable.size")},{default:e(s=>[i(n(ze(s.row.size)),1)]),_:1},8,["label"]),t(L,{prop:"id",label:a(o)("home.modsTable.id")},null,8,["label"]),t(L,{prop:"tags",label:a(o)("home.modsTable.tags")},{default:e(s=>[(v(!0),me(Pe,null,Ae(s.row.tags,Te=>(v(),g(w,{style:{margin:"0 5px 5px 0"}},{default:e(()=>[i(n(Te.display_name),1)]),_:2},1024))),256))]),_:1},8,["label"])]),_:1},8,["data"])),[[de,W.value]])]),_:1},8,["modelValue","title"])])}}},Xe=Se(Je,[["__scopeId","data-v-db8e3623"]]);export{Xe as default};
